I"N(function() {
  var extend = function(child, parent) { for (var key in parent) { if (hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; },
    hasProp = {}.hasOwnProperty;

  AuditReports.Views.StructureCard = (function(superClass) {
    extend(StructureCard, superClass);

    function StructureCard() {
      return StructureCard.__super__.constructor.apply(this, arguments);
    }

    StructureCard.prototype.tagName = 'div';

    StructureCard.prototype.className = 'structure__card';

    StructureCard.prototype.template = _.template("<form class=\"structure__form\">\n  <div class=\"row js-name-row\">\n  </div>\n  <a href=\"#\" class=\"structure__details\" data-trigger=\"collapse\">\n    Details\n  </a>\n  <div class=\"collapsible js-fields-section\">\n  </div>\n</form>");

    StructureCard.prototype.initialize = function(options) {
      var ref;
      if (options == null) {
        options = {};
      }
      this.original = (ref = options.original) != null ? ref : true;
      if (this.original) {
        return this.$el.addClass('js-original-structure');
      } else {
        return this.$el.addClass('js-proposed-structure');
      }
    };

    StructureCard.prototype.render = function() {
      var html;
      html = this.template({
        structureLabel: "" + (this.model.get('name'))
      });
      this.$el.html(html);
      this._addNameCalcField();
      if (this.model.get('multiple')) {
        this._addQuantityCalcField();
      }
      this.$fieldsSection = this.$('.js-calc-fields-section');
      this._renderOriginalStructureFields();
      this._renderCalcFields();
      return this.$el;
    };

    StructureCard.prototype._addNameCalcField = function() {
      var nameCalcField;
      nameCalcField = new AuditReports.Views.NameCalcField({
        model: this.model.get('name_calc_field_value')
      });
      return this.$('.js-name-row').append(nameCalcField.render());
    };

    StructureCard.prototype._addQuantityCalcField = function() {
      var quantityCalcField;
      quantityCalcField = new AuditReports.Views.QuantityCalcField({
        original: this.original,
        model: this.model.get('quantity_calc_field_value')
      });
      return this.$('.js-name-row').append(quantityCalcField.render());
    };

    StructureCard.prototype._renderCalcFields = function() {
      var $row, count;
      $row = null;
      count = 0;
      return this.model.get('calc_field_values').each((function(_this) {
        return function(calcFieldValue, index) {
          var calc_field;
          calc_field = new AuditReports.Views.CalcField({
            model: calcFieldValue
          });
          if (count % 2 === 0) {
            $row = $("<div class='row'></div>");
            _this.$fieldsSection.append($row);
          }
          $row.append(calc_field.render());
          return count += 1;
        };
      })(this));
    };

    StructureCard.prototype._renderOriginalStructureFields = function() {
      return this.model.get('original_structure_field_values').each((function(_this) {
        return function(calcFieldValue) {
          var $row, calc_field, staticCalcField;
          $row = $("<div class='row'></div>");
          _this.$fieldsSection.append($row);
          calc_field = new AuditReports.Views.OriginalStructureField({
            model: calcFieldValue
          });
          $row.append(calc_field.render());
          staticCalcField = new AuditReports.Views.EffectiveStructureCalcField({
            model: calcFieldValue,
            name: "Effective " + (calcFieldValue.get('name'))
          });
          return $row.append(staticCalcField.render());
        };
      })(this));
    };

    return StructureCard;

  })(Backbone.View);

}).call(this);
:ET